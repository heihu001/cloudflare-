<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
<form id="myForm">
  <div class="cf-turnstile" data-sitekey="0x4AAAAAABAC0_SCEHfkEYRO"></div>
  <button type="submit">Submit</button>
</form>
<script>
  document.getElementById('myForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const turnstileElement = document.querySelector('.cf-turnstile');
    if (!turnstileElement || !turnstileElement.turnstile) {
      alert('Turnstile component is not loaded. Please check your network connection.');
      return;
    }

    const token = turnstileElement.turnstile.getResponse();
    if (!token) {
      alert('Please complete the Turnstile verification.');
      return;
    }

    try {
      const response = await fetch('https://t.miniw.workers.dev/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cfturnstiletoken: token })
      });

      if (!response.ok) {
        throw new Error('Network response was not ok.');
      }

      const result = await response.json();
      if (result.success) {
        alert('Verification successful!');
      } else {
        alert('Verification failed!');
      }
    } catch (error) {
      console.error('Error during verification:', error);
      alert('Verification failed. Please try again.');
    }
  });
</script>
